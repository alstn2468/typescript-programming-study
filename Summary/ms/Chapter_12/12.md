# 12ì¥ í”„ë¡œì íŠ¸ ì‹¤ìŠµ

<details><summary>Table of Contents</summary>

-   12-1 ë¹…ë°ì´í„° ë°°ì¹˜ í”„ë¡œê·¸ë¨ ë§Œë“¤ê¸° [:link:](#12-1-ë¹…ë°ì´í„°-ë°°ì¹˜-í”„ë¡œê·¸ë¨-ë§Œë“¤ê¸°)
    -   ì‹¤ìŠµ í”„ë¡œì íŠ¸ êµ¬ì„± [:link:](#ì‹¤ìŠµ-í”„ë¡œì íŠ¸-êµ¬ì„±)
    -   CSV íŒŒì¼ê³¼ ìƒì„±ê¸° [:link:](#csv-íŒŒì¼ê³¼-ìƒì„±ê¸°)
    -   node.jsì—ì„œ í”„ë¡œê·¸ë¨ ëª…ë ¹ ì¤„ ì¸ìˆ˜ ì½ê¸° [:link:](#nodejsì—ì„œ-í”„ë¡œê·¸ë¨-ëª…ë ¹-ì¤„-ì¸ìˆ˜-ì½ê¸°)
    -   íŒŒì¼ ì²˜ë¦¬ ë¹„ë™ê¸° í•¨ìˆ˜ë¥¼ Promiseë¡œ êµ¬í˜„í•˜ê¸° [:link:](#íŒŒì¼-ì²˜ë¦¬-ë¹„ë™ê¸°-í•¨ìˆ˜ë¥¼-promiseë¡œ-êµ¬í˜„í•˜ê¸°)
    -   ê·¸ëŸ´ë“¯í•œ ê°€ì§œ ë°ì´í„° ë§Œë“¤ê¸° [:link:](#ê·¸ëŸ´ë“¯í•œ-ê°€ì§œ-ë°ì´í„°-ë§Œë“¤ê¸°)
    -   Object.keysì™€ Object.values í•¨ìˆ˜ ì‚¬ìš©í•˜ê¸° [:link:](#objectkeysì™€-objectvalues-í•¨ìˆ˜-ì‚¬ìš©í•˜ê¸°)
    -   CSV íŒŒì¼ ë§Œë“¤ê¸° [:link:](#csv-íŒŒì¼-ë§Œë“¤ê¸°)
    -   ë°ì´í„°ë¥¼ CSV íŒŒì¼ì— ì“°ê¸° [:link:](#ë°ì´í„°ë¥¼-csv-íŒŒì¼ì—-ì“°ê¸°)
    -   zip í•¨ìˆ˜ ë§Œë“¤ê¸° [:link:](#zip-í•¨ìˆ˜-ë§Œë“¤ê¸°)
    -   ìƒì„±ê¸° ì½”ë“œë¥¼ êµ¬í˜„í•  ë•Œ ì£¼ì˜í•  ì  [:link:](#ìƒì„±ê¸°-ì½”ë“œë¥¼-êµ¬í˜„í• -ë•Œ-ì£¼ì˜í• -ì )
    -   CSV íŒŒì¼ ë°ì´í„° ì½ê¸° [:link:](#csv-íŒŒì¼-ë°ì´í„°-ì½ê¸°)
-   12-2 ëª½ê³ DBì— ë°ì´í„° ì €ì¥í•˜ê¸° [:link:](#12-2-ëª½ê³ dbì—-ë°ì´í„°-ì €ì¥í•˜ê¸°)
-   12-3 ìµìŠ¤í”„ë ˆìŠ¤ë¡œ API ì„œë²„ ë§Œë“¤ê¸° [:link:](#12-3-ìµìŠ¤í”„ë ˆìŠ¤ë¡œ-api-ì„œë²„-ë§Œë“¤ê¸°)
-   12-4 ë¦¬ì•¡íŠ¸ì™€ ë¶€íŠ¸ìŠ¤íŠ¸ë©ìœ¼ë¡œ í”„ë¡ íŠ¸ì—”ë“œ ì›¹ ë§Œë“¤ê¸° [:link:](#12-4-ë¦¬ì•¡íŠ¸ì™€-ë¶€íŠ¸ìŠ¤íŠ¸ë©ìœ¼ë¡œ-í”„ë¡ íŠ¸ì—”ë“œ-ì›¹-ë§Œë“¤ê¸°)

</details>

## 12-1 ë¹…ë°ì´í„° ë°°ì¹˜ í”„ë¡œê·¸ë¨ ë§Œë“¤ê¸°

### ì‹¤ìŠµ í”„ë¡œì íŠ¸ êµ¬ì„±

ì´ í”„ë¡œì íŠ¸ì—ì„œëŠ” `node.js`ì˜ `fs` íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ `@types/node` íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•œë‹¤.<br/>
ì•„ë˜ì˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•´ `package.json` íŒŒì¼ì„ ìƒì„±í•˜ê³  íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•œë‹¤.<br/>

```shell
> npm init --y
> npm i -D typescript ts-node @types/node
```

í´ë”ë¥¼ ìƒì„±í•˜ê³  ì‚­ì œí•˜ëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ ì•„ë˜ì˜ ë‘ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•œë‹¤.<br/>

```shell
> npm i -S mkdirp rimraf
> npm i -D @types/mkdirp @types/rimraf
```

ë˜í•œ ê°€ì§œ ë°ì´í„°ë¥¼ ë§Œë“¤ì–´ì£¼ëŠ” `chance` íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•œë‹¤.<br/>

```shell
> npm i -S chance
> npm i -D @types/chance
```

`tsconfig.json` íŒŒì¼ì€ ì•„ë˜ì™€ ê°™ì´ ì„¤ì •í•œë‹¤.<br/>

```json
{
    "compilerOptions": {
        "module": "CommonJS",
        "esModuleInterop": true,
        "target": "es5",
        "moduleResolution": "node",
        "outDir": "dist",
        "baseUrl": ".",
        "sourceMap": true,
        "downlevelIteration": true,
        "noImplicitAny": false,
        "paths": {
            "*": ["node_modules/*"]
        }
    },
    "include": ["src/**/*"]
}
```

ì•„ë˜ì™€ ê°™ì´ í”„ë¡œì íŠ¸ì— í•„ìš”í•œ í´ë”ë“¤ì„ ìƒì„±í•´ì¤€ë‹¤.<br/>

```shell
> mkdir -p src/fileApi
> mkdir src/fake
> mkdir src/csv
> mkdir src/utils
> mkdir src/test
```

### CSV íŒŒì¼ê³¼ ìƒì„±ê¸°

Javascriptë‚˜ TypescriptëŠ” íŒŒì¼ì— ë°ì´í„°ë¥¼ ì €ì¥í•  ë•Œ ì£¼ë¡œ `JSON` í¬ë§·ì„ ì‚¬ìš©í•œë‹¤.<br/>
í•˜ì§€ë§Œ ì €ì¥í•  ë°ì´í„°ì˜ ì–‘ì´ ë§ì•„ì§€ë©´ `JSON`íŒŒì¼ í¬ë§·ì€ ì‹œìŠ¤í…œ ë©”ëª¨ë¦¬ë¥¼ ë§ì´ ì‚¬ìš©í•œë‹¤.<br/>
ë”°ë¼ì„œ ë°ì´í„°ë¥¼ íŒŒì¼ì— ì €ì¥í•  ë•ŒëŠ” `JSON`ì²˜ëŸ¼ ë‚˜ì¤‘ì— ì½ê¸° ì‰¬ìš´ í˜•ì‹ìœ¼ë¡œ ë§Œë“ ë‹¤.<br/>
ë³´í†µ í…Œì´ë¸” í˜•íƒœì˜ ë°ì´í„°ëŠ” íŒŒì¼ í™•ì¥ìê°€ `csv`ì¸ íŒŒì¼ì— ì €ì¥í•œë‹¤.<br/>
CSV íŒŒì¼ì€ ë°ì´í„°ê°€ ì•„ë˜ì™€ ê°™ì€ í˜•ì‹ìœ¼ë¡œ ì €ì¥ëœ íŒŒì¼ì„ ë§í•œë‹¤.<br/>

```csv
name,email,ip,phone
Leona Alexander,ikefo@ved.ws,32.133.3.226,(502) 739-6533
```

CSV íŒŒì¼ í˜•ì‹ì€ ë§¨ ì²« ì¤„ì˜ í—¤ë” ì •ë³´ì— ë°ì´í„°ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì´ë¦„ì„ `,`ë¡œ êµ¬ë¶„í•œë‹¤.<br/>
ê·¸ ë‹¤ìŒ ì¤„ë¶€í„°ëŠ” ê° ì´ë¦„ì— í•´ë‹¹í•˜ëŠ” ë°ì´í„°ë¥¼ ë˜‘ê°™ì´ `,`ë¡œ êµ¬ë¶„í•´ ë†“ì„ ìˆ˜ ìˆë‹¤.<br/>
ë˜í•œ CSVíŒŒì¼ì€ JSONíŒŒì¼ê³¼ ë‹¬ë¦¬ ë°ì´í„°ë¥¼ í•œêº¼ë²ˆì— ì½ì§€ ì•Šê³  í•œì¤„ ì”© ì½ëŠ”ë‹¤.<br/>
**ìƒì„±ê¸°**ëŠ” ì‹œìŠ¤í…œ ìì›ì„ ë§¤ìš° ì ê²Œ ì†Œëª¨í•˜ë©° ì—„ì²­ë‚œ ë¶„ëŸ‰ì˜ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.<br/>
CSVíŒŒì¼ì„ í•œ ì¤„ì”© ì½ìœ¼ë©° Typescript ê°ì²´ë¡œ ë³€í™˜í•œ í›„ `yield`ë¬¸ìœ¼ë¡œ ë„˜ê²¨ì¤„ ìˆ˜ ìˆë‹¤.<br/>
`for...of` êµ¬ë¬¸ìœ¼ë¡œ `yield`ë¬¸ìœ¼ë¡œ ë„˜ê²¨ë°›ì€ í•˜ë‚˜ì˜ ê°ì²´ë¥¼ ëŒ€ìƒìœ¼ë¡œ ì‘ì—…ì„ ì§„í–‰í•œë‹¤.<br/>

### node.jsì—ì„œ í”„ë¡œê·¸ë¨ ëª…ë ¹ ì¤„ ì¸ìˆ˜ ì½ê¸°

`node.js` í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•˜ë©´ ì•„ë˜ì²˜ëŸ¼ ì‹¤í–‰ ëª…ë ¹ ë’¤ì— ì—¬ëŸ¬ ê°œì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ì…ë ¥í•  ìˆ˜ ìˆë‹¤.<br/>

```shell
> ts-node src/test/processArgs-test.ts data/fake.csv 100000
```

ì´ì™€ ê°™ì´ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•  ë•Œ ì™¸ë¶€ì—ì„œ ì…ë ¥ëœ ê°’ì„ **ëª…ë ¹ ì¤„ ì¸ìˆ˜**ë¼ê³  í•œë‹¤.<br/>
`node.js`ê°€ ì œê³µí•˜ëŠ” `process` ë‚´ì¥ ê°ì²´ì˜ `argv` ë°°ì—´ ì†ì„±ì—ì„œ **ëª…ë ¹ ì¤„ ì¸ìˆ˜**ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.<br/>

-   `test/processArgs-Test.ts`

```typescript
process.argv.forEach((val: string, index: number) => {
    console.log(index + ": " + val);
});
```

-   `test/processArgs-Test.ts` ì‹¤í–‰ê²°ê³¼

```shell
0: C:\...\nodejs\node_modules\ts-node\dist\bin.js
1: C:\...\test\processArgs-test.ts
2: data/fake.csv
3: 100000
```

ìœ„ì™€ ê°™ì´ `data/fake.csv`ì™€ `100000` ê°’ì€ `index`ê°€ `2`ì™€ `3`ì¼ ë•Œ ì–»ì–´ì§€ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.<br/>
ì´ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ `utils` í´ë”ì— `getFileNameAndNumber.ts` í•¨ìˆ˜ë¥¼ ì‘ì„±í•œë‹¤.<br/>

-   `utils/getFileNameAndNumber.ts`

```typescript
export type FileNameAndNumber = [string, number];

export const getFileNameAndNumber = (
    defaultFileName: string,
    defaultNumberOfFakeData: number
): FileNameAndNumber => {
    const [bin, node, filename, numberOfFakeData] = process.argv;
    return [
        filename || defaultFileName,
        numberOfFakeData
            ? parseInt(numberOfFakeData, 10)
            : defaultNumberOfFakeData,
    ];
};
```

ì•„ë˜ì˜ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‚¬ìš©í•´ ì‘ì„±í•œ `getFileNameAndNumber` í•¨ìˆ˜ë¥¼ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆë‹¤.<br/>

-   `test/getFileNameAndNumber-Test.ts`

```typescript
import { getFileNameAndNumber } from "../utils/getFileNameAndNumber";

const [fileName, numberOfFakeItems] = getFileNameAndNumber(
    "data/fake.csv",
    100000
);
console.log(fileName, numberOfFakeItems); // data/fake.csv 100000
```

ìœ„ì™€ ê°™ì´ **ëª…ë ¹ ì¤„ ì¸ìˆ˜**ë¡œ ë„˜ê¸´ íŒŒì¼ ì´ë¦„ê³¼ ìˆ«ìë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.<br/>

### íŒŒì¼ ì²˜ë¦¬ ë¹„ë™ê¸° í•¨ìˆ˜ë¥¼ Promiseë¡œ êµ¬í˜„í•˜ê¸°

#### (1) fs.access APIë¡œ ë””ë ‰í„°ë¦¬ë‚˜ íŒŒì¼ í™•ì¸í•˜ê¸°

`fs.access` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ íŒŒì¼ì´ë‚˜ ë””ë ‰í„°ë¦¬ê°€ ìˆëŠ”ì§€ ì—†ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br/>
ì•„ë˜ ì½”ë“œëŠ” íŒŒì¼ì´ë‚˜ ë””ë ‰í„°ë¦¬ê°€ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ê¸°ëŠ¥ì„ `Promise` í˜•íƒœë¡œ êµ¬í˜„í–ˆë‹¤.<br/>

-   `fileApi/fileExists.ts`

```typescript
import * as fs from "fs";

export const fileExists = (filePath: string): Promise<boolean> =>
    new Promise((resolve) =>
        fs.access(filePath, (error) => resolve(error ? false : true))
    );
```

`fs.access` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ íŒŒì¼ì´ë‚˜ ë””ë ‰í„°ë¦¬ê°€ ìˆëŠ”ì§€ í™•ì¸í•´ `Promise`ë¥¼ ë°˜í™˜í•œë‹¤.<br/>
ì•„ë˜ì˜ í…ŒìŠ¤íŠ¸ ì½”ë“œë¡œ ì‘ì„±í•œ `fileExists` í•¨ìˆ˜ë¥¼ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆë‹¤.<br/>

-   `test/fileExists-Test.ts`

```typescript
import { fileExists } from "../fileApi/fileExists";

const exists = async (filePath) => {
    const result = await fileExists(filePath);
    console.log(`${filePath} ${result ? "exists" : "not exists"}`);
};

exists("./package.json"); // ./package.json exists
exists("./package"); // ./package not exists
```

ìœ„ì™€ ê°™ì´ íŒŒì¼ì´ë‚˜ ë””ë ‰í„°ë¦¬ì˜ ì¡´ì¬ì—¬ë¶€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.<br/>

#### (2) mkdirp íŒ¨í‚¤ì§€ë¡œ ë””ë ‰í„°ë¦¬ ìƒì„± í•¨ìˆ˜ ë§Œë“¤ê¸°

`node.js`ëŠ” `mkdir`ì´ë¼ëŠ” APIë¥¼ ì œê³µí•œë‹¤.<br/>
í•˜ì§€ë§Œ `mkdir`ì€ `./src/data/today`ì²˜ëŸ¼ ì—¬ëŸ¬ ê²½ë¡œì˜ ë””ë ‰í„°ë¦¬ë¥¼ í•œë²ˆì— ë§Œë“¤ì§€ëŠ” ëª»í•œë‹¤.<br/>
ë°˜ë©´ì— `mkdirp` íŒ¨í‚¤ì§€ëŠ” `mkdir -p` ì²˜ëŸ¼ í•œë²ˆì— ì—¬ëŸ¬ ë””ë ‰í„°ë¦¬ë¥¼ ë§Œë“œëŠ” ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.<br/>
ì•„ë˜ ì½”ë“œëŠ” ë””ë ‰í„°ë¦¬ê°€ ìˆëŠ”ì§€ë¥¼ íŒë‹¨í•´ ì—†ì„ ë•Œë§Œ `mkdirp` í•¨ìˆ˜ë¡œ ë””ë ‰í„°ë¦¬ë¥¼ ìƒì„±í•œë‹¤.<br/>

-   `fileApi/mkdir.ts`

```typescript
import mkdirp from "mkdirp";
import { fileExists } from "./fileExists";

export const mkdir = (dirname: string): Promise<string> =>
    new Promise(async (resolve, reject) => {
        const alreadyExists = await fileExists(dirname);
        alreadyExists
            ? resolve(dirname)
            : mkdirp(dirname, (error) =>
                  error ? reject(error) : resolve(dirname)
              );
    });
```

ì•„ë˜ì˜ í…ŒìŠ¤íŠ¸ ì½”ë“œë¡œ ë™ì‘ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br/>

-   `test/mkdir-Test.ts`

```typescript
import { mkdir } from "../fileApi/mkdir";

const makeDataDir = async (dirname: string) => {
    let result = await mkdir(dirname);
    console.log(`'${result}' dir created`);
};

makeDataDir("./data/today"); // './data/today' dir created
```

ìœ„ì˜ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë©´ í”„ë¡œì íŠ¸ ê²½ë¡œì— `data` í´ë”ì™€ ê·¸ ì•ˆì— `today` í´ë”ê°€ ìƒê¸´ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.<br/>

#### (3) rimraf íŒ¨í‚¤ì§€ë¡œ ë””ë ‰í„°ë¦¬ ì‚­ì œ í•¨ìˆ˜ ë§Œë“¤ê¸°

`node.js`ëŠ” í´ë”ë¥¼ ì‚­ì œí•˜ëŠ” `fs.rmdir`ì´ë¼ëŠ” í•¨ìˆ˜ë¥¼ ì œê³µí•œë‹¤.<br/>
`fs.rmdir` í•¨ìˆ˜ëŠ” ë¹„ì–´ ìˆì§€ ì•Šì€ ë””ë ‰í„°ë¥´ëŠ” ì‚­ì œí•˜ì§€ ëª»í•˜ëŠ” ë¬¸ì œì ì´ ìˆë‹¤.<br/>
`rimraf` íŒ¨í‚¤ì§€ë¥¼ ì´ìš©í•˜ë©´ ë¹„ì–´ ìˆì§€ ì•Šì€ ë””ë ‰í„°ë¦¬ ë˜í•œ ì‚­ì œí•  ìˆ˜ ìˆë‹¤.<br/>
ì•„ë˜ ì½”ë“œëŠ” `rimraf` í•¨ìˆ˜ë¡œ ë””ë ‰í„°ë¦¬ ì‚­ì œ í•¨ìˆ˜ `rmdir`ì„ êµ¬í˜„í•œë‹¤.<br/>

-   `fileApi/rmdir.ts`

```typescript
import rimraf from "rimraf";
import { fileExists } from "./fileExists";

export const rmdir = (dirname: string): Promise<string> =>
    new Promise(async (resolve, reject) => {
        const alreadyExists = await fileExists(dirname);
        !alreadyExists
            ? resolve(dirname)
            : rimraf(dirname, (error) =>
                  error ? reject(error) : resolve(dirname)
              );
    });
```

ì•„ë˜ì˜ í…ŒìŠ¤íŠ¸ ì½”ë“œë¡œ ë™ì‘ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br/>

-   `test/rmdir-Test.ts`

```typescript
import { rmdir } from "../fileApi/rmdir";

const deleteDataDir = async (dir) => {
    const result = await rmdir(dir);
    console.log(`'${result}' dir deleted.`);
};

deleteDataDir("./data/today"); // './data/today' dir deleted.
```

ìœ„ì˜ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë©´ í”„ë¡œì íŠ¸ ê²½ë¡œì— `today` í´ë”ê°€ ì‚­ì œ ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.<br/>

#### (4) fs.writeFile APIë¡œ íŒŒì¼ ìƒì„±í•˜ê¸°

`node.js` í™˜ê²½ì—ì„œ íŒŒì¼ì˜ ë°ì´í„°ë¥¼ ì½ê±°ë‚˜ ì“¸ ë•ŒëŠ” ëŒ€ë¶€ë¶„ í…ìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ëŒ€ìƒìœ¼ë¡œ í•œë‹¤.<br/>
í…ìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•  ë•Œì—ëŠ” ìœ ë‹ˆì½”ë“œë¡œ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•´ì•¼í•œë‹¤.<br/>
ìœ ë‹ˆì½”ë“œ í…ìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•  ë•Œ `fs.writeFile` APIëŠ” ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.<br/>

```typescript
import * as fs from "fs";

fs.writeFile(filepath, data, "utf8", callback);
```

ì•„ë˜ ì½”ë“œëŠ” `fs.writeFile`ì„ `Promise`ë¥¼ ë°˜í™˜í•˜ë„ë¡ êµ¬í˜„í•œ í•¨ìˆ˜ë‹¤.<br/>

-   `fileApi/writeFile.ts`

```typescript
import * as fs from "fs";

export const writeFile = (filename: string, data: any): Promise<any> =>
    new Promise((resolve, reject) => {
        fs.writeFile(filename, data, "utf8", (error: Error) => {
            error ? reject(error) : resolve(data);
        });
    });
```

ì•„ë˜ì˜ í…ŒìŠ¤íŠ¸ ì½”ë“œëŠ” `./data` í´ë”ë¥¼ ìƒì„±í•˜ê³  `hello.txt`ì™€ `test.json` íŒŒì¼ì„ ì‘ì„±í•˜ëŠ” ì˜ˆì‹œë‹¤.<br/>

-   `test/writeFile-Test.ts`

```typescript
import { writeFile } from "../fileApi/writeFile";
import { mkdir } from "../fileApi/mkdir";

const writeTest = async (filename: string, data: any) => {
    const result = await writeFile(filename, data);
    console.log(`wrtie ${result} to ${filename}`);
};

mkdir("./data")
    .then((s) => writeTest("./data/hello.txt", "hello world"))
    .then((s) =>
        writeTest(
            "./data/test.json",
            JSON.stringify({ name: "Jack", age: 32 }, null, 2)
        )
    )
    .catch((e: Error) => console.log(e.message));

// wrtie hello world to ./data/hello.txt
// wrtie {
//   "name": "Jack",
//   "age": 32
// } to ./data/test.json
```

`hello.txt`ì™€ `test.json` íŒŒì¼ì´ ìƒì„±ë˜ê³  ë‚´ìš©ì´ ì‘ì„±ë˜ì–´ìˆëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.<br/>
ê°ì²´ë¥¼ ë¬¸ìì—´ë¡œ ë°”ê¾¸ëŠ” ê¸°ëŠ¥ì˜ ê¸°ë³¸ì ì¸ ì‚¬ìš©ë²•ì€ `JSON.stringify(object)`ê³¼ ê°™ì´ ì‚¬ìš©í•œë‹¤.<br/>
`JSON.stringify(object, null, 2)`ìœ¼ë¡œ ì‚¬ìš©í•´ ì¤„ë°”ê¿ˆê³¼ ë“¤ì—¬ì“°ê¸°ê°€ ë˜ì–´ìˆëŠ” ë°ì´í„°ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤.<br/>
ì—¬ê¸°ì—ì„œ 3ë²ˆì§¸ ì¸ìë¡œ ë„˜ê²¨ì§„ `2`ëŠ” ë“¤ì—¬ì“°ê¸°ë¥¼ ìœ„í•œ ê³µë°± ë¬¸ìì˜ ê°œìˆ˜ë¥¼ ì˜ë¯¸í•œë‹¤.<br/>

#### (5) fs.readFile APIë¡œ íŒŒì¼ ë‚´ìš© ì½ê¸°

íŒŒì¼ì— ë‹´ê¸´ ë°ì´í„°ë¥¼ ì½ì„ ë•ŒëŠ” `fs.readFile` APIë¥¼ ì‚¬ìš©í•œë‹¤.<br/>
íŒŒì¼ì— ë‹´ê¸´ ë°ì´í„°ëŠ” í…ìŠ¤íŠ¸ í¬ë§·ê³¼ ë°”ì´ë„ˆë¦¬ í¬ë§·ìœ¼ë¡œ ì½ì„ ìˆ˜ ìˆë‹¤.<br/>
ë³´í†µ `node.js` í™˜ê²½ì—ì„œ íŒŒì¼ì˜ ë°ì´í„°ë¥¼ ì½ê±°ë‚˜ ì“¸ ë•ŒëŠ” `utf8` í¬ë§·ì„ ì‚¬ìš©í•œë‹¤.<br/>
`fs.readFile` APIë¥¼ ì´ìš©í•´ ìœ ë‹ˆì½”ë“œ í…ìŠ¤íŠ¸ë¥¼ ì½ì„ ë•ŒëŠ” ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í•œë‹¤.<br/>

```typescript
import * as fs from "fs";

fs.readFile(filepath, "utf8", callback);
```

ì•„ë˜ ì½”ë“œëŠ” `fs.readFile`ì„ `Promise`ë¥¼ ë°˜í™˜í•˜ë„ë¡ êµ¬í˜„í•œ í•¨ìˆ˜ë‹¤.<br/>

-   `fileApi/readFile.ts`

```typescript
import * as fs from "fs";

export const readFile = (filename: string): Promise<any> =>
    new Promise<any>((resolve, reject) => {
        fs.readFile(filename, "utf8", (error: Error, data: any) => {
            error ? reject(error) : resolve(data);
        });
    });
```

ì•„ë˜ì˜ í…ŒìŠ¤íŠ¸ ì½”ë“œëŠ”`hello.txt`ì™€ `test.json` íŒŒì¼ì„ `readFile` í•¨ìˆ˜ë¡œ ì½ëŠ” ì˜ˆì‹œë‹¤.<br/>

-   `test/readFile-Test.ts`

```typescript
import { readFile } from "../fileApi/readFile";

const readTest = async (filename: string) => {
    const result = await readFile(filename);
    console.log(`read '${result}' from ${filename} file.`);
};

readTest("./data/hello.txt")
    .then((s) => readTest("./data/test.json"))
    .catch((e: Error) => console.log(e.message));

// read 'hello world' from ./data/hello.txt file.
// read '{
// "name": "Jack",
//     "age": 32
// }' from ./data/test.json file.
```

ìœ„ì™€ ê°™ì´ `writeFile`ë¡œ ìƒì„±í•œ ë‘ ê°œì˜ íŒŒì¼ë“¤ì„ ì˜ ì½ì–´ì˜¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br/>

#### (6) fs.appendFile APIë¡œ íŒŒì¼ ë‚´ìš© ì¶”ê°€í•˜ê¸°

`fs.writeFile`ì€ íŒŒì¼ì´ ì´ë¯¸ ì¡´ì¬í•  ë•ŒëŠ” ê¸°ì¡´ íŒŒì¼ ë‚´ìš©ì„ ëª¨ë‘ ì§€ìš°ê³  ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ ì“´ë‹¤.<br/>
ê¸°ì¡´ ë‚´ìš©ì„ ëì— ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ ì‚½ì…í•˜ê³ ì í•œë‹¤ë©´ `fs.appendFile`ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤.<br/>
ì•„ë˜ ì½”ë“œëŠ” `fs.appendFile`ì„ `Promise`ë¥¼ ë°˜í™˜í•˜ë„ë¡ êµ¬í˜„í•œ í•¨ìˆ˜ë‹¤.<br/>

-   `fileApi/appendFile.ts`

```typescript
import * as fs from "fs";

export const appendFile = (filename: string, data: any): Promise<any> =>
    new Promise((resolve, reject) => {
        fs.appendFile(filename, data, "utf8", (error: Error) => {
            error ? reject(error) : resolve(data);
        });
    });
```

ì•„ë˜ í…ŒìŠ¤íŠ¸ ì½”ë“œëŠ” `./data/hello.txt`ì— `"Hi, there!"`ì´ë¼ëŠ” ë¬¸ìì—´ì„ ì¶”ê°€í•œë‹¤.<br/>

-   `test/appendFile-Test.ts`

```typescript
import { appendFile } from "../fileApi/appendFile";
import { mkdir } from "../fileApi/mkdir";

const appendTest = async (filename: string, data: any) => {
    const result = await appendFile(filename, data);
    console.log(`append ${result} to ${filename}`);
};

mkdir("./data")
    .then((s) => appendTest("./data/hello.txt", "Hi, there!"))
    .catch((e: Error) => console.log(e.message));

// append Hi, there! to ./data/hello.txt
```

`hello.txt`ë¥¼ í™•ì¸í•´ë³´ë©´ `hello worldHi, there!` ê°™ì´ ë°ì´í„°ë¥¼ ìœ ì§€í•˜ë©° ì¶”ê°€ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.<br/>

#### (7) fs.unlink APIë¡œ íŒŒì¼ ì‚­ì œí•˜ê¸°

`node.js` í™˜ê²½ì—ì„œ íŒŒì¼ì„ ì‚­ì œí•  ë•ŒëŠ” `fs.unlink` APIë¥¼ ì‚¬ìš©í•œë‹¤.<br/>
ì•„ë˜ì˜ `deleteFile` í•¨ìˆ˜ëŠ” íŒŒì¼ì´ ì¡´ì¬í•˜ëŠ”ì§€ íŒë³„í•´ ì¡´ì¬í•  ë•Œ íŒŒì¼ì„ ì‚­ì œí•˜ëŠ” ê¸°ëŠ¥ì„ í•œë‹¤.<br/>

-   `fileApi/deleteFile.ts`

```typescript
import * as fs from "fs";
import { fileExists } from "./fileExists";

export const deleteFile = (filename: string): Promise<string> =>
    new Promise<any>(async (resolve, reject) => {
        const alreadyExists = await fileExists(filename);
        !alreadyExists
            ? resolve(filename)
            : fs.unlink(filename, (error) =>
                  error ? reject(error) : resolve(filename)
              );
    });
```

ì•„ë˜ í…ŒìŠ¤íŠ¸ ì½”ë“œëŠ” `./data` í´ë”ì— ìˆëŠ” ë°ì´í„°ì™€ `./data` í´ë”ë¥¼ ì‚­ì œí•œë‹¤.<br/>

-   `test/deleteFile-Test.ts`

```typescript
import { deleteFile } from "../fileApi/deleteFile";
import { rmdir } from "../fileApi/rmdir";

const deleteTest = async (filename: string) => {
    const result = await deleteFile(filename);
    console.log(`delete ${result} file.`);
};

Promise.all([deleteTest("./data/hello.txt"), deleteTest("./data/test.json")])
    .then((s) => rmdir("./data"))
    .then((dirname) => console.log(`delete ${dirname} dir.`))
    .catch((e: Error) => console.log(e.message));

//delete ./data/test.json file.
//delete ./data/hello.txt file.
//delete ./data dir.
```

ìœ„ì˜ ì½”ë“œë¥¼ ì‹¤í–‰ì‹œí‚¤ë©´ `./data` í´ë” ë‚´ë¶€ì˜ íŒŒì¼ê³¼ `./data`í´ë”ê°€ ì‚­ì œë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.<br/>

#### (8) fileApi/index.ts íŒŒì¼ ë§Œë“¤ê¸°

`src/fileApi` í´ë”ì— `index.ts` íŒŒì¼ì„ ìƒì„±í•˜ê³  ì•„ë˜ì˜ ë‚´ìš©ì„ ì‘ì„±í•œë‹¤.<br/>

-   `fileApi/index.ts`

```typescript
import { mkdir } from "./mkdir";
import { rmdir } from "./rmdir";
import { readFile } from "./readFile";
import { writeFile } from "./writeFile";
import { fileExists } from "./fileExists";
import { appendFile } from "./appendFile";
import { deleteFile } from "./deleteFile";

export {
    fileExists,
    mkdir,
    rmdir,
    writeFile,
    readFile,
    appendFile,
    deleteFile,
};
```

`export`ë¥¼ ì´ìš©í•´ ë‹¤ë¥¸ íŒŒì¼ì—ì„œ êµ¬í˜„ëœ í•¨ìˆ˜ë“¤ì„ ëª¨ë‘ ë‹¤ì‹œ ë‚´ë³´ë‚¸ë‹¤.<br/>
ì•ìœ¼ë¡œ `fileApi` í´ë”ì•ˆì— êµ¬í˜„ëœ í•¨ìˆ˜ë“¤ì€ `./src/fileApi`ì—ì„œ ê°€ì ¸ì™€ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.<br/>

### ê·¸ëŸ´ë“¯í•œ ê°€ì§œ ë°ì´í„° ë§Œë“¤ê¸°

ì•ê³¼ ë™ì¼í•˜ê²Œ `chance` íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•´ ê·¸ëŸ´ë“¯í•œ ê°€ì§œ ë°ì´í„°ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤.<br/>
`IFake`ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ í”„ë¡œí•„ ì •ë³´ë¥¼ ê°–ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ ì•„ë˜ì™€ ê°™ì´ êµ¬í˜„í•œë‹¤.<br/>

-   `fake/IFake.ts`

```typescript
export interface IFake {
    name: string;
    email: string;
    sentence: string;
    profession: string;
    birthday: Date;
}
```

`chance` íŒ¨í‚¤ì§€ë¥¼ ì´ìš©í•´ `IFake` ì¸í„°í˜ì´ìŠ¤ í˜•íƒœì˜ ë°ì´í„°ë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì‘ì„±í•œë‹¤.<br/>

-   `fake/makeFakeData.ts`

```typescript
import Chance from "chance";
import { IFake } from "./IFake";

const c = new Chance();

export const makeFakeData = (): IFake => ({
    name: c.name(),
    email: c.email(),
    profession: c.profession(),
    birthday: c.birthday(),
    sentence: c.sentence(),
});

export { IFake };
```

ì•„ë˜ ì½”ë“œë¡œ ì‘ì„±í•œ `makeFakeData` í•¨ìˆ˜ë¥¼ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆë‹¤.<br/>

-   `test/makeFakeData-Test.ts`

```typescript
import { makeFakeData, IFake } from "../fake/makeFakeData";

const fakeData: IFake = makeFakeData();
console.log(fakeData);
// {
//   name: 'Wayne Jenkins',
//   email: 'dair@di.bh',
//   profession: 'Payroll Specialist',
//   birthday: 1992-12-07T17:00:56.753Z,
//   sentence: 'Lo udtizro lezirezu uh opeweten uki eve bob atrepij polur zuwu hoowuse vi focbus.'
// }
```

ìœ„ì™€ ê°™ì´ `IFake` ì¸í„°í˜ì´ìŠ¤ ì†ì„±ì„ ê°–ëŠ” ê°€ì§œ ë°ì´í„°ê°€ ìƒì„±ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.<br/>

### Object.keysì™€ Object.values í•¨ìˆ˜ ì‚¬ìš©í•˜ê¸°

CSV íŒŒì¼ì„ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ” ê°ì²´ì˜ ì†ì„±ê³¼ ê°’ì„ ë¶„ë¦¬í•´ì•¼ í•œë‹¤.<br/>
ì´ ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í•¨ìˆ˜ëŠ” `Object.keys`ì™€ `Object.values` í•¨ìˆ˜ë‹¤.<br/>
ì•„ë˜ì˜ ì½”ë“œëŠ” ì´ ë‘ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ê°ì²´ì˜ ì†ì„± ì´ë¦„ê³¼ ì†ì„± ê°’ìœ¼ë¡œ êµ¬ì„±ëœ ë°°ì—´ì„ ë°˜í™˜í•œë‹¤.<br/>

-   `test/keys-values-Test.ts`

```typescript
import { IFake, makeFakeData } from "../fake/makeFakeData";

const data: IFake = makeFakeData();

const keys = Object.keys(data);
console.log("keys :", keys);
// keys : [ 'name', 'email', 'profession', 'birthday', 'sentence' ]

const values = Object.values(data);
console.log("values :", values);
// values : [
//   'Harriet Carpenter',
//   'jumibe@mono.tf',
//   'Security Director',
//   1968-04-06T22:39:20.764Z,
//   'Muz uw veglivun ho metbifi ta su vefniiw bif wolawi lervimba weogjo al aluko vudatzur.'
// ]
```

ìœ„ì™€ ê°™ì´ `IFake` íƒ€ì… ê°ì²´ì˜ ì†ì„± ì´ë¦„ê³¼ ê°’ì´ ë¶„ë¦¬ë˜ì–´ ë°˜í™˜ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.<br/>

### CSV íŒŒì¼ ë§Œë“¤ê¸°

ê°€ì§œ ë°ì´í„°ë¥¼ ì—¬ëŸ¬ ê°œ ìƒì„±í•´ CSV íŒŒì¼ì— ì“°ê¸°ìœ„í•´ ì•„ë˜ì˜ `range` í•¨ìˆ˜ë¥¼ êµ¬í˜„í•œë‹¤.<br/>

-   `utils/range.ts`

```typescript
export function* range(max: number, min: number = 0) {
    while (min < max) {
        yield min++;
    }
}
```

ì´ì œ ì•ì—ì„œ êµ¬í˜„í•œ í•¨ìˆ˜ë“¤ì„ ì‚¬ìš©í•´ `numberOfItems` ë§Œí¼ `IFake` ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.<br/>
ê·¸ í›„ ì†ì„±ëª…ê³¼ ì†ì„±ê°’ì˜ ë°°ì—´ì„ ê°ê° ì¶”ì¶œí•´ `filename` íŒŒì¼ì„ ìƒì„±í•  ìˆ˜ ìˆë‹¤.<br/>

-   `fake/writeCsvFormatFakeData.ts`

```typescript
import * as path from "path";
import { IFake, makeFakeData } from "./makeFakeData";
import { mkdir, writeFile, appendFile } from "../fileApi";
import { range } from "../utils/range";

export const writeCsvFormatFakeData = async (
    filename: string,
    numberOfItems: number
): Promise<string> => {
    const dirname = path.dirname(filename),
        comma = ",",
        newLine = "\n";
    await mkdir(dirname);

    for (let n of range(numberOfItems)) {
        const fake: IFake = makeFakeData();

        if (n == 0) {
            const keys = Object.keys(fake).join(comma);
            await writeFile(filename, keys);
        }

        const values = Object.values(fake).join(comma);
        await appendFile(filename, newLine + values);
    }

    return `write ${numberOfItems} items to ${filename} file.`;
};
```

CSV íŒŒì¼ì˜ ì²« ì¤„ì€ ê°ì²´ì˜ ì†ì„± ì´ë¦„ì„ ì‰¼í‘œë¡œ êµ¬ë¶„í•´ì„œ ì‘ì„±í•´ì•¼ í•œë‹¤.<br/>
ë”°ë¼ì„œ `Object.keys(fake).join(comma)` ê°™ì´ ì†ì„± ì´ë¦„ ë°°ì—´ì— `join` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ êµ¬í˜„í•˜ì˜€ë‹¤.<br/>
ì´í›„ì—ëŠ” `Object.values(fake).join(comma)` ê°™ì´ ì†ì„± ê°’ ë°°ì—´ì„ `join` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ ì¶”ê°€í•œë‹¤.<br/>
ì§€ê¸ˆê¹Œì§€ êµ¬í˜„í•œ íŒŒì¼ë“¤ì„ ì‚¬ìš©í•˜ê¸° ì‰½ê²Œ `src/fake` í´ë”ì— `index.ts` íŒŒì¼ì„ ì‘ì„±í•œë‹¤.<br/>

-   `fake/index.ts`

```typescript
import { IFake, makeFakeData } from "./makeFakeData";
import { writeCsvFormatFakeData } from "./writeCsvFormatFakeData";

export { IFake, makeFakeData, writeCsvFormatFakeData };
```

ìœ„ì™€ ê°™ì´ ì‘ì„±í•¨ìœ¼ë¡œì¨ `fake` í´ë” ì•ˆì— êµ¬í˜„í•œ ê¸°ëŠ¥ë“¤ì„ `src/fake` ê²½ë¡œì—ì„œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.<br/>

### ë°ì´í„°ë¥¼ CSV íŒŒì¼ì— ì“°ê¸°

### zip í•¨ìˆ˜ ë§Œë“¤ê¸°

### ìƒì„±ê¸° ì½”ë“œë¥¼ êµ¬í˜„í•  ë•Œ ì£¼ì˜í•  ì 

### CSV íŒŒì¼ ë°ì´í„° ì½ê¸°

[[ğŸ”ìœ„ë¡œê°€ê¸°]](#12ì¥-í”„ë¡œì íŠ¸-ì‹¤ìŠµ)&nbsp; / &nbsp;[[ğŸ”™ë’¤ë¡œê°€ê¸°]](https://github.com/alstn2468/DoIt_Typescript_Programming/blob/master/README.md)

## 12-2 ëª½ê³ DBì— ë°ì´í„° ì €ì¥í•˜ê¸°

[[ğŸ”ìœ„ë¡œê°€ê¸°]](#12ì¥-í”„ë¡œì íŠ¸-ì‹¤ìŠµ)&nbsp; / &nbsp;[[ğŸ”™ë’¤ë¡œê°€ê¸°]](https://github.com/alstn2468/DoIt_Typescript_Programming/blob/master/README.md)

## 12-3 ìµìŠ¤í”„ë ˆìŠ¤ë¡œ API ì„œë²„ ë§Œë“¤ê¸°

[[ğŸ”ìœ„ë¡œê°€ê¸°]](#12ì¥-í”„ë¡œì íŠ¸-ì‹¤ìŠµ)&nbsp; / &nbsp;[[ğŸ”™ë’¤ë¡œê°€ê¸°]](https://github.com/alstn2468/DoIt_Typescript_Programming/blob/master/README.md)

## 12-4 ë¦¬ì•¡íŠ¸ì™€ ë¶€íŠ¸ìŠ¤íŠ¸ë©ìœ¼ë¡œ í”„ë¡ íŠ¸ì—”ë“œ ì›¹ ë§Œë“¤ê¸°

[[ğŸ”ìœ„ë¡œê°€ê¸°]](#12ì¥-í”„ë¡œì íŠ¸-ì‹¤ìŠµ)&nbsp; / &nbsp;[[ğŸ”™ë’¤ë¡œê°€ê¸°]](https://github.com/alstn2468/DoIt_Typescript_Programming/blob/master/README.md)
